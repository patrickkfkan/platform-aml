
The kernel is taken from the LibreELEC project and customized as follows:
- A DTD file is added for the Amlogic g02 customer platform (which is used by g18ref devices)
- OverlayFS is required by Volumio but not included in the 3.10.y kernels. A patch is therefore applied to add OverlayFS.

Below are instructions for cross-compiling the kernel on an x86 64-bit platform.

Download toolchain for compiling kernel:
> wget https://releases.linaro.org/components/toolchain/binaries/7.3-2018.05/arm-linux-gnueabihf/gcc-linaro-7.3.1-2018.05-x86_64_arm-linux-gnueabihf.tar.xz
> tar -xf gcc-linaro-7.3.1-2018.05-x86_64_arm-linux-gnueabihf.tar.xz

Set environment variables:
> export PATH=$PWD/gcc-linaro-7.3.1-2018.05-x86_64_arm-linux-gnueabihf/bin:$PATH
> export ARCH=arm
> export CROSS_COMPILE=arm-linux-gnueabihf-

Fetch the kernel:
> git clone https://github.com/LibreELEC/linux-amlogic.git -b amlogic-3.10.y
> cd linux-amlogic

Download and apply kernel patch for Overlayfs:
> wget https://raw.githubusercontent.com/adilinden-oss/overlayfs-patches/master/overlayfs.v18-3.10-rc7.patch
> patch -p1 < overlayfs.v18-3.10-rc7.patch

Copy kernel config and DTD from platform files:
> cp <locationofplatform-aml>/g18ref/boot/config-3.10.108 .config
> cp <locationofplatform-aml>/g18ref/boot/meson6_g02.dtd arch/arm/boot/dts/amlogic

Configure kernel if necessary:
> make menuconfig (for any changes and save to .config)

Make u-boot kernel image with appended DTB:
> make meson6_g02.dtd
> make uImage-dtb

Make kernel modules:
> make modules

Copy kernel image and modules to platform files:
> cp arch/arm/boot/uImage-dtb <locationofplatform-aml>/g18ref/boot/uImage
> make modules_install INSTALL_MOD_PATH=<locationofplatform-aml>/g18ref

